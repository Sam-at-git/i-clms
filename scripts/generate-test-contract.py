#!/usr/bin/env python3
"""
ç”Ÿæˆæµ‹è¯•ç”¨è™šæ‹ŸåˆåŒæ–‡æ¡£
"""

from docx import Document
from docx.shared import Pt, Inches
from docx.enum.text import WD_ALIGN_PARAGRAPH
from datetime import datetime, timedelta
import random

def create_project_outsourcing_contract():
    """åˆ›å»ºé¡¹ç›®å¤–åŒ…åˆåŒ"""
    doc = Document()

    # è®¾ç½®é»˜è®¤å­—ä½“
    style = doc.styles['Normal']
    style.font.name = 'å®‹ä½“'
    style.font.size = Pt(12)

    # æ ‡é¢˜
    title = doc.add_heading('é¡¹ç›®å¤–åŒ…æœåŠ¡åˆåŒ', level=1)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER

    # åˆåŒç¼–å·å’ŒåŸºæœ¬ä¿¡æ¯
    p = doc.add_paragraph()
    p.add_run('åˆåŒç¼–å·ï¼š').bold = True
    p.add_run('CTR-2024-00123\n')
    p.add_run('ç­¾è®¢æ—¥æœŸï¼š').bold = True
    p.add_run('2024-01-15\n')
    p.add_run('ç­¾è®¢åœ°ç‚¹ï¼š').bold = True
    p.add_run('ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº\n')

    doc.add_paragraph()

    # ç”²æ–¹ä¿¡æ¯
    doc.add_heading('ç”²æ–¹ï¼ˆå§”æ‰˜æ–¹ï¼‰', level=2)
    p = doc.add_paragraph()
    p.add_run('å…¬å¸åç§°ï¼š').bold = True
    p.add_run('ä¸Šæµ·æŸæŸç§‘æŠ€æœ‰é™å…¬å¸\n')
    p.add_run('ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼š').bold = True
    p.add_run('91310000XXXXXXXX01\n')
    p.add_run('åœ°å€ï¼š').bold = True
    p.add_run('ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºå¼ æ±Ÿé«˜ç§‘æŠ€å›­åŒºXXXå·\n')
    p.add_run('è”ç³»äººï¼š').bold = True
    p.add_run('å¼ ä¸‰\n')
    p.add_run('ç”µè¯ï¼š').bold = True
    p.add_run('021-12345678\n')

    # ä¹™æ–¹ä¿¡æ¯
    doc.add_heading('ä¹™æ–¹ï¼ˆæœåŠ¡æ–¹ï¼‰', level=2)
    p = doc.add_paragraph()
    p.add_run('å…¬å¸åç§°ï¼š').bold = True
    p.add_run('insigmaè½¯ä»¶æœ‰é™å…¬å¸\n')
    p.add_run('ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼š').bold = True
    p.add_run('91330000XXXXXXXX02\n')
    p.add_run('åœ°å€ï¼š').bold = True
    p.add_run('æ­å·å¸‚æ»¨æ±ŸåŒºé•¿æ²³è·¯XXXå·\n')
    p.add_run('è”ç³»äººï¼š').bold = True
    p.add_run('æå››\n')
    p.add_run('ç”µè¯ï¼š').bold = True
    p.add_run('0571-87654321\n')

    doc.add_paragraph()

    # ç¬¬ä¸€æ¡ï¼šé¡¹ç›®æ¦‚è¿°
    doc.add_heading('ç¬¬ä¸€æ¡ é¡¹ç›®æ¦‚è¿°', level=2)
    doc.add_paragraph(
        '1.1 é¡¹ç›®åç§°ï¼šæ™ºèƒ½åˆåŒç®¡ç†ç³»ç»Ÿå¼€å‘é¡¹ç›®\n'
        '1.2 é¡¹ç›®æè¿°ï¼šä¹™æ–¹ä¸ºç”²æ–¹å¼€å‘ä¸€å¥—æ™ºèƒ½åˆåŒå…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ç³»ç»Ÿï¼ˆi-CLMSï¼‰ï¼Œ'
        'åŒ…æ‹¬åˆåŒä¸Šä¼ ã€æ™ºèƒ½è§£æã€å·¥ä½œæµå®¡æ‰¹ã€è´¢åŠ¡ç®¡ç†ã€äº¤ä»˜è·Ÿè¸ªç­‰åŠŸèƒ½æ¨¡å—ã€‚\n'
        '1.3 é¡¹ç›®ç›®æ ‡ï¼šé€šè¿‡æ™ºèƒ½åŒ–æ‰‹æ®µæå‡ç”²æ–¹åˆåŒç®¡ç†æ•ˆç‡ï¼Œå®ç°åˆåŒæ•°æ®çš„æ•°å­—åŒ–å’Œæ™ºèƒ½åŒ–ç®¡ç†ã€‚'
    )

    # ç¬¬äºŒæ¡ï¼šåˆåŒé‡‘é¢ä¸ä»˜æ¬¾æ–¹å¼
    doc.add_heading('ç¬¬äºŒæ¡ åˆåŒé‡‘é¢ä¸ä»˜æ¬¾æ–¹å¼', level=2)
    doc.add_paragraph(
        '2.1 åˆåŒæ€»ä»·ï¼šæœ¬åˆåŒæ€»é‡‘é¢ä¸ºäººæ°‘å¸å£¹ä½°è´°æ‹¾ä¸‡å…ƒæ•´ï¼ˆÂ¥1,200,000.00å…ƒï¼‰\n'
        '2.2 å«ç¨é‡‘é¢ï¼šÂ¥1,200,000.00å…ƒï¼ˆå«å¢å€¼ç¨ï¼‰\n'
        '2.3 ä¸å«ç¨é‡‘é¢ï¼šÂ¥1,132,075.47å…ƒ\n'
        '2.4 ç¨ç‡ï¼š6%ï¼ˆå¢å€¼ç¨ä¸€èˆ¬çº³ç¨äººï¼‰\n'
        '2.5 å¸ç§ï¼šäººæ°‘å¸ï¼ˆCNYï¼‰\n'
        '2.6 ä»˜æ¬¾æ–¹å¼ï¼šé“¶è¡Œè½¬è´¦\n'
    )

    # ç¬¬ä¸‰æ¡ï¼šä»˜æ¬¾æ¡ä»¶
    doc.add_heading('ç¬¬ä¸‰æ¡ ä»˜æ¬¾æ¡ä»¶ä¸é‡Œç¨‹ç¢‘', level=2)
    doc.add_paragraph(
        'ç”²æ–¹æŒ‰ç…§ä»¥ä¸‹é‡Œç¨‹ç¢‘å‘ä¹™æ–¹æ”¯ä»˜é¡¹ç›®æ¬¾é¡¹ï¼š\n'
    )

    milestones = [
        {
            'name': 'åˆåŒç­¾è®¢',
            'deliverable': 'åˆåŒç­¾ç½²å®Œæˆ',
            'amount': '360,000.00',
            'percentage': '30%',
            'date': '2024-01-20'
        },
        {
            'name': 'éœ€æ±‚ç¡®è®¤ä¸è®¾è®¡å®Œæˆ',
            'deliverable': 'éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ã€ç³»ç»Ÿè®¾è®¡æ–‡æ¡£ã€æ•°æ®åº“è®¾è®¡æ–‡æ¡£',
            'amount': '240,000.00',
            'percentage': '20%',
            'date': '2024-03-15'
        },
        {
            'name': 'å¼€å‘å®Œæˆä¸æµ‹è¯•é€šè¿‡',
            'deliverable': 'ç³»ç»Ÿæºä»£ç ã€æµ‹è¯•æŠ¥å‘Šã€ç”¨æˆ·æ‰‹å†Œ',
            'amount': '360,000.00',
            'percentage': '30%',
            'date': '2024-06-30'
        },
        {
            'name': 'ä¸Šçº¿éªŒæ”¶åˆæ ¼',
            'deliverable': 'ç³»ç»Ÿéƒ¨ç½²å®Œæˆã€éªŒæ”¶æŠ¥å‘Šã€åŸ¹è®­å®Œæˆ',
            'amount': '180,000.00',
            'percentage': '15%',
            'date': '2024-08-15'
        },
        {
            'name': 'è´¨ä¿æœŸæ»¡',
            'deliverable': 'è´¨ä¿æœåŠ¡å®Œæˆã€ç³»ç»Ÿç¨³å®šè¿è¡Œ',
            'amount': '60,000.00',
            'percentage': '5%',
            'date': '2025-02-15'
        }
    ]

    for i, milestone in enumerate(milestones, 1):
        p = doc.add_paragraph(style='List Number')
        p.add_run(f"é‡Œç¨‹ç¢‘{i}ï¼š{milestone['name']}\n").bold = True
        p.add_run(f"  äº¤ä»˜ç‰©ï¼š{milestone['deliverable']}\n")
        p.add_run(f"  ä»˜æ¬¾é‡‘é¢ï¼šÂ¥{milestone['amount']}å…ƒï¼ˆ{milestone['percentage']}ï¼‰\n")
        p.add_run(f"  è®¡åˆ’å®Œæˆæ—¥æœŸï¼š{milestone['date']}\n")

    # ç¬¬å››æ¡ï¼šåˆåŒæœŸé™
    doc.add_heading('ç¬¬å››æ¡ åˆåŒæœŸé™', level=2)
    doc.add_paragraph(
        '4.1 åˆåŒç­¾è®¢æ—¥æœŸï¼š2024å¹´1æœˆ15æ—¥\n'
        '4.2 åˆåŒç”Ÿæ•ˆæ—¥æœŸï¼š2024å¹´1æœˆ20æ—¥\n'
        '4.3 é¡¹ç›®äº¤ä»˜æœŸé™ï¼š2024å¹´8æœˆ15æ—¥\n'
        '4.4 è´¨ä¿æœŸï¼šè‡ªéªŒæ”¶åˆæ ¼ä¹‹æ—¥èµ·12ä¸ªæœˆï¼Œè‡³2025å¹´8æœˆ15æ—¥\n'
        '4.5 åˆåŒæœ‰æ•ˆæœŸï¼šè‡ª2024å¹´1æœˆ20æ—¥è‡³2025å¹´8æœˆ15æ—¥\n'
        '4.6 åˆåŒæœŸé™ï¼šå…±19ä¸ªæœˆ'
    )

    # ç¬¬äº”æ¡ï¼šäº¤ä»˜æ ‡å‡†
    doc.add_heading('ç¬¬äº”æ¡ äº¤ä»˜æ ‡å‡†ä¸éªŒæ”¶', level=2)
    doc.add_paragraph(
        '5.1 äº¤ä»˜ç‰©æ¸…å•ï¼š\n'
        '  - å®Œæ•´çš„ç³»ç»Ÿæºä»£ç ï¼ˆåŒ…å«å‰ç«¯ã€åç«¯ã€æ•°æ®åº“è„šæœ¬ï¼‰\n'
        '  - ç³»ç»Ÿéƒ¨ç½²æ–‡æ¡£\n'
        '  - ç”¨æˆ·æ“ä½œæ‰‹å†Œ\n'
        '  - ç³»ç»Ÿç®¡ç†å‘˜æ‰‹å†Œ\n'
        '  - æµ‹è¯•æŠ¥å‘ŠåŠç”¨ä¾‹\n'
        '  - éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦\n'
        '  - ç³»ç»Ÿè®¾è®¡æ–‡æ¡£\n'
        '  - APIæ¥å£æ–‡æ¡£\n\n'
        '5.2 éªŒæ”¶æ ‡å‡†ï¼š\n'
        '  - ç³»ç»ŸåŠŸèƒ½ç¬¦åˆéœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦\n'
        '  - ç³»ç»Ÿæ€§èƒ½æ»¡è¶³è®¾è®¡æŒ‡æ ‡\n'
        '  - é€šè¿‡ç”²æ–¹ç»„ç»‡çš„UATæµ‹è¯•\n'
        '  - æ–‡æ¡£é½å…¨ã€å‡†ç¡®\n\n'
        '5.3 éªŒæ”¶æµç¨‹ï¼š\n'
        '  ç”²æ–¹åº”åœ¨æ”¶åˆ°äº¤ä»˜ç‰©å15ä¸ªå·¥ä½œæ—¥å†…å®ŒæˆéªŒæ”¶ã€‚éªŒæ”¶é€šè¿‡å3ä¸ªå·¥ä½œæ—¥å†…ç­¾ç½²éªŒæ”¶æŠ¥å‘Šã€‚'
    )

    # ç¬¬å…­æ¡ï¼šå…¶ä»–ä¿¡æ¯
    doc.add_heading('ç¬¬å…­æ¡ å…¶ä»–æ¡æ¬¾', level=2)
    doc.add_paragraph(
        '6.1 é”€å”®è´Ÿè´£äººï¼šç‹ç»ç†\n'
        '6.2 æ‰€å±è¡Œä¸šï¼šä¿¡æ¯æŠ€æœ¯æœåŠ¡ä¸š\n'
        '6.3 åˆåŒä»½æ•°ï¼šæœ¬åˆåŒä¸€å¼è´°ä»½ï¼Œç”²ä¹™åŒæ–¹å„æ‰§å£¹ä»½ï¼Œå…·æœ‰åŒç­‰æ³•å¾‹æ•ˆåŠ›ã€‚\n'
        '6.4 äº‰è®®è§£å†³ï¼šå› æœ¬åˆåŒå¼•èµ·çš„æˆ–ä¸æœ¬åˆåŒæœ‰å…³çš„ä»»ä½•äº‰è®®ï¼ŒåŒæ–¹åº”å‹å¥½åå•†è§£å†³ï¼›'
        'åå•†ä¸æˆçš„ï¼Œä»»ä½•ä¸€æ–¹å‡å¯å‘åˆåŒç­¾è®¢åœ°äººæ°‘æ³•é™¢æèµ·è¯‰è®¼ã€‚'
    )

    # ç¬¬ä¸ƒæ¡ï¼šä¿å¯†æ¡æ¬¾
    doc.add_heading('ç¬¬ä¸ƒæ¡ ä¿å¯†æ¡æ¬¾', level=2)
    doc.add_paragraph(
        '7.1 åŒæ–¹å¯¹åœ¨æœ¬åˆåŒå±¥è¡Œè¿‡ç¨‹ä¸­çŸ¥æ‚‰çš„å¯¹æ–¹å•†ä¸šç§˜å¯†è´Ÿæœ‰ä¿å¯†ä¹‰åŠ¡ã€‚\n'
        '7.2 æœªç»å¯¹æ–¹ä¹¦é¢åŒæ„ï¼Œä»»ä½•ä¸€æ–¹ä¸å¾—å‘ç¬¬ä¸‰æ–¹æŠ«éœ²ã€ä½¿ç”¨æˆ–å…è®¸ç¬¬ä¸‰æ–¹ä½¿ç”¨å¯¹æ–¹çš„å•†ä¸šç§˜å¯†ã€‚\n'
        '7.3 ä¿å¯†æœŸé™è‡ªæœ¬åˆåŒç­¾è®¢ä¹‹æ—¥èµ·è‡³åˆåŒç»ˆæ­¢åä¸‰å¹´å†…æœ‰æ•ˆã€‚'
    )

    # ç­¾ç½²æ 
    doc.add_paragraph()
    doc.add_paragraph()

    table = doc.add_table(rows=3, cols=2)
    table.style = 'Table Grid'

    table.cell(0, 0).text = 'ç”²æ–¹ï¼ˆç›–ç« ï¼‰ï¼š'
    table.cell(0, 1).text = 'ä¹™æ–¹ï¼ˆç›–ç« ï¼‰ï¼š'

    table.cell(1, 0).text = 'æ³•å®šä»£è¡¨äºº/æˆæƒä»£è¡¨ï¼ˆç­¾å­—ï¼‰ï¼š'
    table.cell(1, 1).text = 'æ³•å®šä»£è¡¨äºº/æˆæƒä»£è¡¨ï¼ˆç­¾å­—ï¼‰ï¼š'

    table.cell(2, 0).text = f'æ—¥æœŸï¼š2024å¹´1æœˆ15æ—¥'
    table.cell(2, 1).text = f'æ—¥æœŸï¼š2024å¹´1æœˆ15æ—¥'

    return doc

def create_staff_augmentation_contract():
    """åˆ›å»ºäººåŠ›æ¡†æ¶åˆåŒ"""
    doc = Document()

    style = doc.styles['Normal']
    style.font.name = 'å®‹ä½“'
    style.font.size = Pt(12)

    title = doc.add_heading('äººåŠ›èµ„æºå¤–åŒ…æ¡†æ¶åè®®', level=1)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER

    # åŸºæœ¬ä¿¡æ¯
    p = doc.add_paragraph()
    p.add_run('åˆåŒç¼–å·ï¼š').bold = True
    p.add_run('CTR-2024-00456\n')
    p.add_run('ç­¾è®¢æ—¥æœŸï¼š').bold = True
    p.add_run('2024-02-01\n')

    doc.add_paragraph()

    # ç”²ä¹™åŒæ–¹
    doc.add_heading('ç”²æ–¹ï¼ˆç”¨å·¥æ–¹ï¼‰', level=2)
    p = doc.add_paragraph()
    p.add_run('å…¬å¸åç§°ï¼š').bold = True
    p.add_run('æ­å·æŸæŸäº’è”ç½‘æœ‰é™å…¬å¸\n')

    doc.add_heading('ä¹™æ–¹ï¼ˆæ´¾é£æ–¹ï¼‰', level=2)
    p = doc.add_paragraph()
    p.add_run('å…¬å¸åç§°ï¼š').bold = True
    p.add_run('insigmaè½¯ä»¶æœ‰é™å…¬å¸\n')

    # åˆåŒé‡‘é¢
    doc.add_heading('ç¬¬ä¸€æ¡ æœåŠ¡è´¹ç”¨', level=2)
    doc.add_paragraph(
        '1.1 æ¡†æ¶åˆåŒé¢„ä¼°æ€»é‡‘é¢ï¼šäººæ°‘å¸æŒæ‹¾ä¸‡å…ƒæ•´ï¼ˆÂ¥800,000.00å…ƒï¼‰\n'
        '1.2 è´¹ç‡æ ‡å‡†ï¼ˆæŒ‰å·¥æ—¶è®¡è´¹ï¼‰ï¼š\n'
    )

    rates = [
        {'role': 'é«˜çº§æ¶æ„å¸ˆ', 'rate': '300', 'unit': 'å°æ—¶'},
        {'role': 'é«˜çº§å¼€å‘å·¥ç¨‹å¸ˆ', 'rate': '200', 'unit': 'å°æ—¶'},
        {'role': 'ä¸­çº§å¼€å‘å·¥ç¨‹å¸ˆ', 'rate': '150', 'unit': 'å°æ—¶'},
        {'role': 'åˆçº§å¼€å‘å·¥ç¨‹å¸ˆ', 'rate': '100', 'unit': 'å°æ—¶'},
        {'role': 'æµ‹è¯•å·¥ç¨‹å¸ˆ', 'rate': '120', 'unit': 'å°æ—¶'},
    ]

    for rate in rates:
        p = doc.add_paragraph(style='List Bullet')
        p.add_run(f"{rate['role']}ï¼šÂ¥{rate['rate']}å…ƒ/{rate['unit']}")

    doc.add_paragraph(
        '\n1.3 ç»“ç®—å‘¨æœŸï¼šæŒ‰æœˆç»“ç®—\n'
        '1.4 ç¨ç‡ï¼š6%\n'
        '1.5 é¢„ä¼°æ€»å·¥æ—¶ï¼šçº¦4000å°æ—¶\n'
        '1.6 åˆåŒæœŸé™ï¼š2024å¹´3æœˆ1æ—¥è‡³2025å¹´2æœˆ28æ—¥ï¼ˆ12ä¸ªæœˆï¼‰'
    )

    return doc

def main():
    """ä¸»å‡½æ•°"""
    import os

    # ç¡®ä¿scriptsç›®å½•å­˜åœ¨
    script_dir = os.path.dirname(os.path.abspath(__file__))

    # ç”Ÿæˆé¡¹ç›®å¤–åŒ…åˆåŒ
    print("æ­£åœ¨ç”Ÿæˆé¡¹ç›®å¤–åŒ…åˆåŒ...")
    doc1 = create_project_outsourcing_contract()
    contract1_path = os.path.join(script_dir, 'æµ‹è¯•åˆåŒ-é¡¹ç›®å¤–åŒ….docx')
    doc1.save(contract1_path)
    print(f"âœ… å·²ç”Ÿæˆï¼š{contract1_path}")

    # ç”ŸæˆäººåŠ›æ¡†æ¶åˆåŒ
    print("\næ­£åœ¨ç”ŸæˆäººåŠ›æ¡†æ¶åˆåŒ...")
    doc2 = create_staff_augmentation_contract()
    contract2_path = os.path.join(script_dir, 'æµ‹è¯•åˆåŒ-äººåŠ›æ¡†æ¶.docx')
    doc2.save(contract2_path)
    print(f"âœ… å·²ç”Ÿæˆï¼š{contract2_path}")

    print("\n" + "="*50)
    print("ğŸ‰ æµ‹è¯•åˆåŒç”Ÿæˆå®Œæˆï¼")
    print("="*50)
    print("\nç”Ÿæˆçš„æ–‡ä»¶åŒ…å«ï¼š")
    print("1. é¡¹ç›®å¤–åŒ…åˆåŒï¼šåŒ…å«å®Œæ•´çš„åˆåŒä¿¡æ¯ã€é‡Œç¨‹ç¢‘ã€ä»˜æ¬¾æ¡ä»¶ç­‰")
    print("2. äººåŠ›æ¡†æ¶åˆåŒï¼šåŒ…å«è´¹ç‡ã€å·¥æ—¶ã€ç»“ç®—å‘¨æœŸç­‰")
    print("\næ‚¨å¯ä»¥ä¸Šä¼ è¿™äº›æ–‡ä»¶åˆ°ç³»ç»Ÿè¿›è¡Œæµ‹è¯•ã€‚")

if __name__ == '__main__':
    main()
