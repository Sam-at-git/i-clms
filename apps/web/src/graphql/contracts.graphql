query GetContractsWithFilter($filter: ContractFilterInput, $skip: Int, $take: Int, $orderBy: ContractOrderInput) {
  contracts(filter: $filter, skip: $skip, take: $take, orderBy: $orderBy) {
    nodes {
      id
      contractNo
      name
      type
      status
      ourEntity
      amountWithTax
      currency
      signedAt
      expiresAt
      parseStatus
      createdAt
      customer {
        id
        name
        shortName
      }
      department {
        id
        name
        code
      }
    }
    totalCount
    hasNextPage
    hasPreviousPage
  }
}

query GetContract($id: ID!) {
  contract(id: $id) {
    id
    contractNo
    name
    type
    status
    ourEntity
    amountWithTax
    amountWithoutTax
    currency
    taxRate
    taxAmount
    paymentMethod
    paymentTerms
    signedAt
    effectiveAt
    expiresAt
    duration
    fileUrl
    fileType
    industry
    salesPerson
    parseStatus
    parsedAt
    parseConfidence
    needsManualReview
    createdAt
    updatedAt
    customer {
      id
      name
      shortName
      creditCode
      industry
      address
      contactPerson
      contactPhone
      contactEmail
    }
    department {
      id
      name
      code
    }
    uploadedBy {
      id
      name
      email
    }
  }
}

mutation CreateContract($input: CreateContractInput!) {
  createContract(input: $input) {
    id
    contractNo
    name
  }
}

mutation UpdateContractById($id: ID!, $input: UpdateContractInput!) {
  updateContract(id: $id, input: $input) {
    id
    contractNo
    name
    status
  }
}

mutation DeleteContract($id: ID!) {
  deleteContract(id: $id)
}

mutation ParseAndExtract($objectName: String!) {
  parseAndExtract(objectName: $objectName) {
    success
    text
    pageCount
    extractedFields {
      contractNumber
      contractName
      partyA
      partyB
      signDate
      amount
      validPeriod
      rawMatches {
        field
        value
        confidence
      }
    }
  }
}

mutation ConvertUploadedFileToMarkdown($objectName: String!, $options: DoclingConvertOptions) {
  convertUploadedFileToMarkdown(objectName: $objectName, options: $options) {
    success
    markdown
    pages
    tables {
      markdown
      rows
      cols
    }
    images {
      page
      width
      height
    }
    error
  }
}

mutation DetectContractType($markdown: String!) {
  detectContractType(markdown: $markdown) {
    detectedType
    confidence
    reasoning
    displayName
    description
  }
}

mutation CreateParseSession($objectName: String!) {
  createParseSession(objectName: $objectName)
}

mutation ParseContractWithLlm($objectName: String!) {
  parseContractWithLlm(objectName: $objectName) {
    success
    extractedData {
      contractType
      basicInfo {
        contractNo
        contractName
        ourEntity
        customerName
        status
      }
      financialInfo {
        amountWithTax
        amountWithoutTax
        taxRate
        currency
        paymentMethod
        paymentTerms
      }
      timeInfo {
        signedAt
        effectiveAt
        expiresAt
        duration
      }
      otherInfo {
        salesPerson
        industry
        signLocation
        copies
      }
      typeSpecificDetails
    }
    rawText
    pageCount
    llmModel
    llmProvider
    processingTimeMs
    sessionId
    error
  }
}

mutation StartParseContractAsync($objectName: String!, $strategy: ParseStrategyType, $markdown: String) {
  startParseContractAsync(objectName: $objectName, strategy: $strategy, markdown: $markdown) {
    sessionId
    message
  }
}

query GetParseProgress($sessionId: String!) {
  getParseProgress(sessionId: $sessionId) {
    sessionId
    objectName
    status
    currentStage
    totalChunks
    completedChunks
    currentChunkIndex
    progressPercentage
    chunks {
      chunkId
      chunkIndex
      totalChunks
      purpose
      status
      startTime
      endTime
      error
    }
    totalTasks
    completedTasks
    currentTaskInfo
    tasks {
      taskId
      infoType
      infoTypeName
      status
      startTime
      endTime
      error
      data
    }
    startTime
    estimatedEndTime
    processingTimeMs
    error
    extractedFieldsCount
    estimatedRemainingSeconds
    resultData
  }
}

query CheckContractDuplicate($contractNo: String!) {
  checkContractDuplicate(contractNo: $contractNo) {
    isDuplicate
    existingContract {
      id
      contractNo
      name
      type
      status
      ourEntity
      amountWithTax
      amountWithoutTax
      currency
      signedAt
      effectiveAt
      expiresAt
      paymentMethod
      paymentTerms
      customer {
        id
        name
      }
      department {
        id
        name
      }
    }
    message
  }
}

mutation CreateOrUpdateContract($input: CreateContractInput!, $forceUpdate: Boolean, $operatorId: ID) {
  createOrUpdateContract(input: $input, forceUpdate: $forceUpdate, operatorId: $operatorId) {
    id
    contractNo
    name
    type
    status
    amountWithTax
    signedAt
    customer {
      id
      name
    }
  }
}
